(window.webpackJsonp=window.webpackJsonp||[]).push([[92],{"+871":function(module,e,t){"use strict";t.r(e),t.d(e,"PracticeQuizAttemptPage",function(){return O}),t.d(e,"withRedirectToCover",function(){return q});var n=t("VbXa"),s=t.n(n),a=t("DXTi"),i=t.n(a),r=t("MnCE"),o=t("EqTq"),u=t("m10x"),c=t("+LJP"),d=t("usGt"),m=t("sQ/U"),l=t("JEIr"),p=t("oe9u"),f=t("/oRK"),I=t("XFHP"),g=t("22Sa"),b=t("eK4/"),v=t("Gpyo"),y=t("xmEj"),S=t("RH4a"),D=t("zaiP"),h=t("wIYG"),R=t("4QSv"),P=t("VtNW"),Q=t.n(P),z=t("3AUy"),E=t.n(z),j=Object(o.a)("PracticeQuizAttemptPage"),O=function(e){function PracticeQuizAttemptPage(){return e.apply(this,arguments)||this}s()(PracticeQuizAttemptPage,e);var t=PracticeQuizAttemptPage.prototype;return t.componentDidMount=function componentDidMount(){var e=this.props,t=e.shouldRedirectToCover,n=e.redirectToCover;t&&n()},t.render=function render(){var e=this.props,t=e.redirectToCover,n=e.addRedirectToCoverToRouteParams,s=e.examSessionId;return i.a.createElement(D.a,null,function(e){var a=e.item;if(!a)return null;return i.a.createElement(g.a,{onClose:t,ariaLabel:Q()("Practice Quiz"),backbuttonAriaLabel:Q()("Back to the Course"),headerLeft:i.a.createElement(p.a,{headerText:a.name,itemTypeText:Q()("Practice Quiz"),timeCommitment:a.timeCommitment}),headerRight:i.a.createElement(f.a,{deadline:a.deadline}),topBanner:i.a.createElement(l.a,{slug:a.courseSlug,itemId:a.id,userId:m.a.get().id},function(e){var n=e.bestEvaluation;return i.a.createElement(v.b,{slug:a.courseSlug,itemId:a.id,userId:m.a.get().id,fetchPolicy:"network-only",examSessionId:s},function(e){var s=e.isSubmitted,r,o=(a.contentSummary&&"quiz"===a.contentSummary.typeName&&a.contentSummary.definition||{}).passingFraction,u=n||{},c=u.score,d=void 0===c?0:c,m=u.maxScore,l=void 0===m?0:m,p=n?l&&d/l:void 0,f=p?p>=o:void 0;if(s&&o&&"number"==typeof p)return i.a.createElement(R.a,{passingFraction:o,itemGrade:{grade:p,isPassed:f||!1,isOverridden:!1,latePenaltyRatio:null},onKeepLearningClick:t,onTryAgainClick:t});return null})})},i.a.createElement(v.b,{slug:a.courseSlug,itemId:a.id,userId:m.a.get().id,fetchPolicy:"network-only",examSessionId:s},function(e){var t=e.loading,s=e.practiceQuizFormData,r=e.sessionId,o=e.nextSubmissionDraftId,c=e.totalPoints,d=e.isSubmitted,m=e.hasDraft;if(t||!s)return i.a.createElement(h.a,null);var l=s.map(function(e){return e.prompt.id});return i.a.createElement(S.a,{itemId:a.id,courseId:a.courseId},function(e){var t=e.stepState,p=e.setStepState;return i.a.createElement("div",{className:j()},i.a.createElement("div",{className:j("header")},i.a.createElement(u.d,null,a.name),i.a.createElement(u.a,{rootClassName:j("points")},i.a.createElement(u.h,{tag:"span"},Q()("Total points #{totalPoints}",{totalPoints:c})))),i.a.createElement("div",{className:j("prompts")},s.map(function(e,n){return i.a.createElement(b.a,{key:e.prompt.id,quizQuestion:e,index:n,isReadOnly:!!d,isDisabled:!!(t||{}).isSaving||!!(t||{}).isSubmitting})})),!d&&i.a.createElement(y.a,{ids:l,sessionId:r,nextSubmissionDraftId:o},function(e){var s=e.saveDraft,r=e.autoSaveDraft,o=e.submitDraft;return i.a.createElement(I.a,{itemId:a.id,courseId:a.courseId,saveDraft:s,autoSaveDraft:r,submitDraft:function submitDraft(){return o?o().then(function(){n()}):Promise.reject()},hasDraft:m,stepState:t,setStepState:p})}))})}))})},PracticeQuizAttemptPage}(i.a.Component),q=Object(r.compose)(d.a,Object(c.a)(function(e,t){var n=t.refetchPracticeQuizCoverPageData,s=t.refreshProgress;return{redirectToCover:function redirectToCover(){n&&n(),e.push({name:"practice-quiz-cover",params:e.params,query:e.location.query}),s()},addRedirectToCoverToRouteParams:function addRedirectToCoverToRouteParams(){e.push({name:"practice-quiz-attempt",params:e.params,query:{redirectToCover:!0}})},shouldRedirectToCover:e.location.query.redirectToCover}}));e.default=q(O)},Gpyo:function(module,e,t){"use strict";t.d(e,"a",function(){return p}),t.d(e,"c",function(){return g});var n=t("MVZn"),s=t.n(n),a=t("VkAN"),i=t.n(a),r=t("DXTi"),o=t.n(r),u=t("lTCR"),c=t.n(u),d=t("oJmH"),m=t.n(d),l=t("TUhR");function _templateObject2(){var e=i()(['\n  query practiceQuizDataQuery(\n    $itemId: String!\n    $userId: Int!\n    $slug: String!\n    $sessionId: String!\n    $body: String!\n    $skipFetchingResponses: Boolean!\n  ) {\n    practiceQuizQuestionData(itemId: $itemId, userId: $userId, slug: $slug, sessionId: $sessionId, body: $body)\n      @rest(\n        type: "RestPracticeQuizQuestionGetStateData"\n        path: "opencourse.v1/user/{args.userId}/course/{args.slug}/item/{args.itemId}/quiz/session/{args.sessionId}/action/getState?autoEnroll=false"\n        method: "POST"\n        bodyKey: "body"\n      ) {\n      contentResponseBody @type(name: "RestPracticeQuizQuestionDataResponseBody") {\n        return @type(name: "RestContentResponseBodyReturnObject") {\n          questions\n          nextSubmissionDraftId\n        }\n      }\n    }\n    practiceQuizQuestionResponses(itemId: $itemId, userId: $userId, slug: $slug, sessionId: $sessionId, body: $body)\n      @skip(if: $skipFetchingResponses)\n      @rest(\n        type: "RestPracticeQuizLatestSubmissionDraftResponse"\n        path: "opencourse.v1/user/{args.userId}/course/{args.slug}/item/{args.itemId}/quiz/session/{args.sessionId}/action/getLatestSubmissionDraft?autoEnroll=false"\n        method: "POST"\n        bodyKey: "body"\n      ) {\n      contentResponseBody @type(name: "RestPracticeQuizQuestionDataResponseBody") {\n        return @type(name: "RestContentResponseBodyReturnObject") {\n          draft\n        }\n      }\n    }\n  }\n']);return _templateObject2=function _templateObject2(){return e},e}function _templateObject(){var e=i()(['\n  query practiceQuizSessionMetaDataQuery($itemId: String!, $userId: Int!, $slug: String!, $body: String!) {\n    practiceQuizSessionMetaData(body: $body, itemId: $itemId, userId: $userId, slug: $slug)\n      @rest(\n        type: "RestPracticeQuizSessionMetadata"\n        path: "opencourse.v1/user/{args.userId}/course/{args.slug}/item/{args.itemId}/quiz/session"\n        method: "POST"\n        bodyKey: "body"\n      ) {\n      contentResponseBody @type(name: "RestPracticeQuizSessionDataResponseBody")\n    }\n  }\n']);return _templateObject=function _templateObject(){return e},e}var p={contentRequestBody:{argument:[]}},f={contentRequestBody:[]},I=c()(_templateObject()),g=c()(_templateObject2()),b=function PracticeQuizData(e){var t=e.slug,n=e.itemId,a=e.userId,i=e.fetchPolicy,r=void 0===i?"cache-first":i,u=e.examSessionId,c=e.children,m={slug:t,itemId:n,userId:a};return o.a.createElement(d.Query,{query:I,variables:s()({},m,{body:f}),fetchPolicy:r,skip:!!u},function(e){var t=e.loading,n=e.data,a=e.refetch;if(t&&!u)return c({loading:t});var i=u||((((n||{}).practiceQuizSessionMetaData||{}).contentResponseBody||{}).session||{}).id;return o.a.createElement(d.Query,{query:g,variables:s()({},m,{sessionId:i,body:p,skipFetchingResponses:!!u}),fetchPolicy:r},function(e){var t=e.loading,n=e.data,s=e.refetch,r=e.client;if(t)return c({loading:t});var o=(((n||{}).practiceQuizQuestionData||{}).contentResponseBody||{}).return,d=o.questions,m=o.nextSubmissionDraftId,p,f,I,g=((((((n||{}).practiceQuizQuestionResponses||{}).contentResponseBody||{}).return||{}).draft||{}).input||{}).responses,b=Object(l.a)(d,g,!!u),v=b.reduce(function(e,t){return e+t.prompt.weightedScoring.maxScore},0),y=!d[0].isSubmitAllowed,S,D;return c({loading:t,practiceQuizFormData:b,sessionId:i,totalPoints:v,isSubmitted:y,nextSubmissionDraftId:m,hasDraft:!!g,refetchPracticeQuizData:function refetchPracticeQuizData(){return a().then(function(){return s()})},client:r})})})};e.b=b},"a7+h":function(module,e,t){"use strict";t.d(e,"a",function(){return I});var n=t("VkAN"),s=t.n(n),a=t("DXTi"),i=t.n(a),r=t("lTCR"),o=t.n(r),u=t("oJmH"),c=t.n(u),d=t("kqcj");function _templateObject2(){var e=s()(['\n  mutation practiceQuizSubmitResponseActionMutation(\n    $itemId: String!\n    $userId: Int!\n    $slug: String!\n    $sessionId: String!\n    $body: String!\n  ) {\n    action(itemId: $itemId, userId: $userId, slug: $slug, sessionId: $sessionId, body: $body)\n      @rest(\n        type: "PracticeQuizSubmitResponseData"\n        path: "opencourse.v1/user/{args.userId}/course/{args.slug}/item/{args.itemId}/quiz/session/{args.sessionId}/action/submitResponses?autoEnroll=false"\n        method: "POST"\n        bodyKey: "body"\n      ) {\n      contentResponseBody @type(name: "RestPracticeQuizQuestionDataResponseBody") {\n        return @type(name: "RestContentResponseBodyReturnObject") {\n          nextSubmissionDraftId\n          evaluation\n          questions\n        }\n      }\n    }\n  }\n']);return _templateObject2=function _templateObject2(){return e},e}function _templateObject(){var e=s()(['\n  mutation practiceQuizSaveSubmissionDraftActionMutation(\n    $itemId: String!\n    $userId: Int!\n    $slug: String!\n    $sessionId: String!\n    $body: String!\n    $additionalParams: String!\n  ) {\n    action(\n      itemId: $itemId\n      userId: $userId\n      slug: $slug\n      sessionId: $sessionId\n      body: $body\n      additionalParams: $additionalParams\n    )\n      @rest(\n        type: "PracticeQuizSaveSubmissionDraftData"\n        path: "opencourse.v1/user/{args.userId}/course/{args.slug}/item/{args.itemId}/quiz/session/{args.sessionId}/action/saveSubmissionDraft?autoEnroll=false{args.additionalParams}"\n        method: "POST"\n        bodyKey: "body"\n      ) {\n      contentResponseBody @type(name: "RestPracticeQuizQuestionDataResponseBody") {\n        return @type(name: "RestContentResponseBodyReturnObject") {\n          nextSubmissionDraftId\n          questions @skip(if: $skipQuestionsField)\n          evaluation\n        }\n      }\n    }\n  }\n']);return _templateObject=function _templateObject(){return e},e}var m=o()(_templateObject()),l=o()(_templateObject2()),p=function SaveDraftMutation(e){var t=e||{},n=t.changedResponses,s=t.nextSubmissionDraftId,a=t.sessionId,r=t.userId,o=t.itemId,c=t.slug;return i.a.createElement(u.Mutation,{mutation:m,update:Object(d.a)(e)},function(t){var i={contentRequestBody:{argument:{id:s,input:{responses:n}}}},u=function saveDraft(){return t({variables:{body:i,sessionId:a,userId:r,itemId:o,slug:c,skipQuestionsField:!0,additionalParams:""}})},d=function autoSaveDraft(){return t({variables:{body:i,sessionId:a,userId:r,itemId:o,slug:c,skipQuestionsField:!0,additionalParams:"&isAutoSaving=true"}})};return e.children({saveDraft:u,autoSaveDraft:d})})},f=function SubmitDraftMutation(e){var t=e||{},n=t.changedResponses,s=t.sessionId,a=t.userId,r=t.itemId,o=t.slug;return i.a.createElement(u.Mutation,{mutation:l,update:Object(d.a)(e)},function(t){var i={contentRequestBody:{argument:{responses:n}}},u=function submitDraft(){return t({variables:{body:i,sessionId:s,userId:a,itemId:r,slug:o}})};return e.children({submitDraft:u})})},I=function PracticeQuizMutations(e){var t=e.ids,n=e.sessionId,s=e.itemId,a=e.courseId,r=e.changedResponses,o=e.children,u=e.slug,c=e.userId,d=e.nextSubmissionDraftId;return i.a.createElement(p,{changedResponses:r,nextSubmissionDraftId:d,sessionId:n,userId:c,itemId:s,slug:u},function(e){var t=e.saveDraft,a=e.autoSaveDraft;return i.a.createElement(f,{changedResponses:r,sessionId:n,userId:c,itemId:s,slug:u},function(e){var n=e.submitDraft;return o({saveDraft:t,autoSaveDraft:a,submitDraft:n})})})},g=I},kqcj:function(module,e,t){"use strict";var n=t("Gpyo"),s=function practiceQuizActionMutationUpdate(e){return function(t,s){var a=s.data,i=e.itemId,r=e.userId,o=e.slug,u=e.sessionId,c=(((a||{}).action||{}).contentResponseBody||{}).return||null,d=t.readQuery({query:n.c,variables:{itemId:i,userId:r,slug:o,sessionId:u,skipFetchingResponses:!1,body:n.a}}),m=(((d||{}).practiceQuizQuestionData||{}).contentResponseBody||{}).return||null;m&&(m.nextSubmissionDraftId=(c||{}).nextSubmissionDraftId||null,m.questions=(c||{}).questions||m.questions||null,m.evaluation=(c||{}).evaluation||null,t.writeQuery({query:n.c,variables:{itemId:i,userId:r,slug:o,sessionId:u,skipFetchingResponses:!1,body:n.a},data:d}))}};e.a=s},xmEj:function(module,e,t){"use strict";var n=t("DXTi"),s=t.n(n),a=t("agp5"),i=t("RH4a"),r=t("0n3a"),o=t("zaiP"),u=t("JEIr"),c=t("sQ/U"),d=t("wjH1"),m=t("a7+h"),l=function PracticeQuizActions(e){var t=e.ids,n=e.sessionId,l=e.children,p=e.nextSubmissionDraftId;return s.a.createElement(o.a,null,function(e){var o=e.item;if(!o)return null;var f=o.courseId,I=o.id,g=o.courseSlug;return s.a.createElement(u.a,{userId:c.a.get().id,itemId:I,slug:g},function(e){var u=e.refetch;return s.a.createElement(a.a,{ids:t},function(e){if(!e||!u)return l({});return s.a.createElement(i.a,{itemId:I,courseId:f},function(a){var i=a.stepState,b=a.setStepState,v=e.map(function(e){return{questionInstance:e.id,response:((e.response||{}).definition||{}).value}});return s.a.createElement(m.a,{ids:t,sessionId:n,itemId:I,courseId:f,slug:g,userId:c.a.get().id,changedResponses:v,nextSubmissionDraftId:p},function(t){var n=t.saveDraft,a=t.submitDraft,c=function saveDraft(){if(!i.isSaving&&!i.isSubmitting&&p)return b({isSaving:!0}),n().then(function(){return b({isSaving:!1})}).catch(function(e){return Object(d.a)(e,b)});return Promise.reject()},m=function autoSaveDraft(){if(!i.isAutoSaving&&!i.isSubmitting&&p)return b({isAutoSaving:!0}),n().then(function(){return b({isAutoSaving:!1})}).catch(function(e){return Object(d.a)(e,b)});return Promise.reject()},f=function refetchItemAndEvaluations(){return u().then(function(){return o.refetch()}).catch(function(e){return Object(d.a)(e,b)})},I=function submitDraft(){if(!i.isSubmitting)return b({isSubmitting:!0}),a().then(function(){return b({isSubmitting:!1})}).then(f).catch(function(e){return Object(d.a)(e,b)});return Promise.reject()};return s.a.createElement(r.a,{stepState:i,saveDraft:m,changedResponses:e},function(){return l({saveDraft:c,autoSaveDraft:m,submitDraft:I})})})})})})})};e.a=l}}]);
//# sourceMappingURL=92.b44a7c3e075ff94ed465.js.map